CREATE DATABASE `app` /*!40100 DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci */ /*!80016 DEFAULT ENCRYPTION='N' */;

CREATE TABLE `items` (
  `id` smallint DEFAULT NULL,
  `title` varchar(200) DEFAULT NULL,
  `text` text
)

DELIMITER $$
CREATE PROCEDURE `items_getDetails`(
	IN id SMALLINT
)
BEGIN	
    
	SELECT 
		items.id,
        items.title,
        items.text
    FROM items    
    where items.id=id;
    
END$$
DELIMITER ;


DELIMITER $$
CREATE PROCEDURE `items_getList`(
	IN pageSize INT,
    IN page INT
)
BEGIN	
    DECLARE startIndex INT DEFAULT (pageSize * (page - 1));      
      
	SELECT 
		items.id,
        items.title,
        substring(items.text,1,300) as text
    FROM items    
    limit startIndex, pageSize;
    
    select count(1) as itemCount from items;
    
END$$
DELIMITER ;
